<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Palestinian Voices in Games - Supported Projects</title>
    <!-- Open Graph / Facebook -->
    <meta property="og:type" content="website" />
    <meta property="og:url" content="https://palestinian-voices-in-games.com/" />
    <meta property="og:title" content="Palestinian Voices in Games" />
    <meta
      property="og:description"
      content="A professional network for supporting Palestinian game creators. We connect Palestinian indie game developers with international volunteers and funding partners to help bring their stories to global audiences." />
    <meta property="og:image" content="https://palestinian-voices-in-games.com/images/pvig.png" />
    <meta property="og:image:width" content="1200" />
    <meta property="og:image:height" content="630" />
    <meta property="og:site_name" content="Palestinian Voices in Games" />

    <!-- Twitter -->
    <meta property="twitter:card" content="summary_large_image" />
    <meta property="twitter:url" content="https://palestinian-voices-in-games.com/" />
    <meta property="twitter:title" content="Palestinian Voices in Games" />
    <meta
      property="twitter:description"
      content="A professional network for supporting Palestinian game creators. We connect Palestinian indie game developers with international volunteers and funding partners." />
    <meta property="twitter:image" content="https://palestinian-voices-in-games.com/images/pvig.png" />

    <!-- Additional meta tags -->
    <meta
      name="description"
      content="A professional network for supporting Palestinian game creators. We connect Palestinian indie game developers with international volunteers and funding partners to help bring their stories to global audiences." />
    <link rel="canonical" content="https://palestinian-voices-in-games.com/" />

    <!-- Favicon -->
    <link rel="icon" type="image/png" href="/my-favicon/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/my-favicon/favicon.svg" />
    <link rel="shortcut icon" href="/my-favicon/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/my-favicon/apple-touch-icon.png" />
    <link rel="manifest" href="/my-favicon/site.webmanifest" />

    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="style.css" />

    <style></style>
  </head>
  <body style="overflow: hidden;">

    <iframe id="ProjectFrame" src="" style="position: absolute;left: 0;border: none;width: 100vw;height: 100vh;" title="Project description"></iframe>

    <div id="ProjectFooter" hidden>
      <div class="container mt-5 position-relative">

        <!-- "How It Works": do not include -->
        <!-- 
        <section class="my-5">
          <h2>How It Works</h2>
          <div class="row">
            <div class="col-md-6">
              <h4>Volunteer Network</h4>
              <p>
                International professionals pledge hours to mentor, advise, or otherwise support selected Palestinian projects. Volunteers of all
                disciplines, both in and around game development, are needed and welcome!
              </p>
            </div>
            <div class="col-md-6">
              <h4>Funding</h4>
              <p>
                We are currently brainstorming ways to connect creators with prospective financing sources, from donations of all sizes to investors and
                publishers.
              </p>
            </div>
          </div>
        </section>
        -->

        <!-- "Get Involved": do not include -->
        <!-- 
        <section class="my-5">
          <h2>Get Involved</h2>
          <div class="contact-grid">
            <div class="action-group">
              <p>Want to sign up to volunteer your time or offer financial support?</p>
              <div class="text-center">
                <a href="https://forms.gle/hHKjnMYMjmo3dDmo7" class="btn btn-primary custom-btn">Join us!</a>
              </div>
            </div>
            <div class="action-group">
              <p>Are you a Palestinian game creator looking for support?</p>
              <div class="text-center">
                <a href="https://forms.gle/U6goepMRjowgJN2U6" class="btn btn-primary custom-btn">Request support!</a>
              </div>
            </div>
            <div class="action-group">
              <p>Have questions? Want to learn more? Reach out!</p>
              <div class="text-center">
                <a href="mailto:palestinianvoicesingames@gmail.com" class="btn btn-primary custom-btn">Email Us</a>
              </div>
            </div>
          </div>
        </section>
        -->

        <!-- "News letter" section: include -->
        <div class="newsletter-section">
          <p>
            <strong>Additional projects</strong> of various sizes are currently being reviewed and the network continues to expand its roster of
            volunteers and industry partners.
          </p>
        </div>
      </div>
    </div>

    <button onclick="ToggleProjectMenu(true)" class="project-menu-toggle"></button>
    <div class="project-menu">
      <h3>Projects</h3>
      <button onclick="ClickProjectButton(0)" class="project-button selected-project">Dreams on a Pillow</button>
      <button onclick="ClickProjectButton(1)" class="project-button">Being 2 (working title)</button>
      <button onclick="ClickProjectButton(2)" class="project-button">RiYafa</button>
      <button onclick="ClickProjectButton(3)" class="project-button">Pomegranates</button>
    </div>

    <div><canvas id="TransitionFilter" style="position: fixed;z-index: 10;top: 0;left: 0;width: 100%;height: 100%;pointer-events: none;user-select: none;" /></div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.3/dist/umd/popper.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>

	<script>
	{
		// Convert a color name or color code into a RGBA array [red, green, blue, alpha]
		function ColorToRGBA(color) {
			const cvs = document.createElement("canvas");
			cvs.width = 1;
			cvs.height = 1;
			const ctx = cvs.getContext("2d");
			ctx.fillStyle = color;
			ctx.fillRect(0, 0, 1, 1);
			return ctx.getImageData(0, 0, 1, 1).data;
		}
		
		const EnableTransitions = true; // Turn off to disable the transition animations
		const TransitionTimeout = 25; // Display refresh rate in milliseconds
		const TransitionSpeedFadeIn = 1; // Speed factor for the transition step that slowly hides the previous page
		const TransitionSpeedFadeOut = 1; // Speed factor for the transition step that slowly shows the incoming page
		
		// List of project pages, in the same order as the "project-button" buttons
		const ProjectList = [[TransitionSandNoise_Loop, "projects/dreams-on-a-pillow.html"],
							[TransitionSwipe_Loop, "projects/being-2.html"],
							[TransitionWave_Loop, "projects/riyafa.html"],
							[TransitionTide_Loop, "projects/pomegranates.html"]];
		
		// Transition objects
		const backgroundColor = ColorToRGBA(getComputedStyle(document.body).backgroundColor);
		const projectFooter = document.getElementById("ProjectFooter");
		const canvas = document.getElementById("TransitionFilter");
		canvas.width = 300;
		canvas.height = 300 * screen.height / screen.width;
		const context = canvas.getContext("2d");
		const imgdata = context.createImageData(canvas.width, canvas.height);
		
		var ProjectPage = ProjectList[0][1]; // Current (or incoming) project page
		var TransitionFunc = ProjectList[0][0]; // Current (or incoming) transition function
		var TransitionStep = 0; // 0: no transition, 1: fadein, 2: fadeout
		var TransitionCounter = 50; // The counter for transitions, usually ranging from 50 to -5 (fadein) or from -5 to 50 (fadeout)
		var ShowAllProjects = false; // When enabled, all the projects are displayed at once on the same page
		
		// What happens after a project page is loaded
		function OnProjectPageLoad() {
			const projectFrame = document.getElementById("ProjectFrame");
			try { ProjectFrame.contentWindow.scrollTo(0, 400); }
			catch {}
			var pageElements = ProjectFrame.contentDocument?.getElementsByClassName("project-card");
			if (pageElements?.length > 0) {
				pageElements = [...pageElements];
				if (ShowAllProjects) {
					// ShowAllProjects mode: create a hidden <iframe> for each project page not loaded yet...
					var allProjectPages = [];
					var allProjectCounter = 0;
					for (var page of ProjectList) {
						if (ProjectFrame.src.endsWith(page[1]))
							continue;
						var pageIFrame = document.createElement("iframe");
						allProjectPages.push(pageIFrame);
						allProjectCounter++;
						pageIFrame.hidden = true;
						pageIFrame.src = page[1];
						pageIFrame.onload = function() {
							allProjectCounter--;
							if (allProjectCounter <= 0) {
								// ... and append their content to the main page once they all loaded
								for (pageIFrame of allProjectPages) {
									const pageTokens = pageIFrame.contentDocument?.getElementsByClassName("project-card");
									if (pageTokens != null) {
										for (var pageToken of pageTokens) {
											pageElements[pageElements.length - 1].insertAdjacentElement("afterend", pageToken);
											pageElements.push(pageToken);
										}
									}
								}
								pageElements[pageElements.length - 1].insertAdjacentHTML("afterend", projectFooter.innerHTML);
							}
						};
						document.body.appendChild(pageIFrame);
					}
				} else {
					// In normal mode: just append (a duplicate of) the footer
					pageElements[pageElements.length - 1].insertAdjacentHTML("afterend", projectFooter.innerHTML);
				}
			}
		}
		document.getElementById("ProjectFrame").onload = OnProjectPageLoad;
		
		// Control the transition's flow (page change, fadein/fadeout loops)
		function NextLoopCheck(func, fadein, fadeout) {
			if (TransitionStep == 1) {
				TransitionCounter -= TransitionSpeedFadeIn;
				if (fadein) {
					window.setTimeout(func, TransitionTimeout);
				} else {
					TransitionStep = 2;
					document.getElementById("ProjectFrame").src = ProjectPage;
					window.setTimeout(TransitionFunc, TransitionTimeout);
				}
			} else {
				TransitionCounter += TransitionSpeedFadeOut;
				if (fadeout) {
					window.setTimeout(func, TransitionTimeout);
				} else {
					TransitionStep = 0;
					canvas.hidden = true;
				}
			}
		}
		
		// A transition that looks like a circular wave propagating through the page
		function TransitionWave_Loop() {
			const centerx = canvas.width / 2;
			const centery = canvas.height / 2;
			var x, y, imgindex, alpha;
			var hasalpha = false;
			for (var x = 0; x < canvas.width; x++) {
				for (var y = 0; y < canvas.height; y++) {
					imgindex = (canvas.width * y + x) * 4;
					var dist = Math.sqrt((x - centerx) * (x - centerx) + (y - centery) * (y - centery));
					if (2 * TransitionCounter - 50 > dist) {
						alpha = 0;
					} else {
						hasalpha = true;
						alpha = (1 + Math.cos(0.5 * dist - TransitionCounter)) / 2;
						alpha /= Math.max(0, dist - 2 * TransitionCounter) + 1;
						alpha = 1 - alpha;
						alpha /= Math.max(0, 0.2 * TransitionCounter - 0.1 * dist) + 1;
					}
					imgdata.data[imgindex] = backgroundColor[0];
					imgdata.data[imgindex + 1] = backgroundColor[1];
					imgdata.data[imgindex + 2] = backgroundColor[2];
					imgdata.data[imgindex + 3] = alpha * 0xFF;
				}
			}
			context.putImageData(imgdata, 0, 0);
			NextLoopCheck(TransitionWave_Loop, TransitionCounter >= -5, hasalpha);
		}
		
		// A transition that looks like granularity spreading
		function TransitionSandNoise_Loop() {
			var x, y, imgindex, alpha;
			for (var x = 0; x < canvas.width; x++) {
				for (var y = 0; y < canvas.height; y++) {
					imgindex = (canvas.width * y + x) * 4;
					alpha = Math.min(Math.max(Math.random(), 1 - 0.04 * TransitionCounter), 1 - 0.02 * TransitionCounter);
					imgdata.data[imgindex] = backgroundColor[0];
					imgdata.data[imgindex + 1] = backgroundColor[1];
					imgdata.data[imgindex + 2] = backgroundColor[2];
					imgdata.data[imgindex + 3] = alpha * 0xFF;
				}
			}
			context.putImageData(imgdata, 0, 0);
			NextLoopCheck(TransitionSandNoise_Loop, TransitionCounter >= -5, TransitionCounter < 50);
		}
		
		// A simple transition that opens vertically
		function TransitionSwipe_Loop() {
			var x, y, imgindex, alpha;
			for (var x = 0; x < canvas.width; x++) {
				for (var y = 0; y < canvas.height; y++) {
					imgindex = (canvas.width * y + x) * 4;
					alpha = Math.min(1, Math.max(0, Math.sign(y - canvas.height / 2) * Math.cos(10 * x / canvas.width) + Math.abs(y - canvas.height / 2) * 20 / canvas.height - TransitionCounter / 5));
					imgdata.data[imgindex] = backgroundColor[0];
					imgdata.data[imgindex + 1] = backgroundColor[1];
					imgdata.data[imgindex + 2] = backgroundColor[2];
					imgdata.data[imgindex + 3] = alpha * 0xFF;
				}
			}
			context.putImageData(imgdata, 0, 0);
			NextLoopCheck(TransitionSwipe_Loop, TransitionCounter >= -5, TransitionCounter < 50);
		}
		
		// A transition that looks like a raising tide
		var transitionTide_Shift = 0;
		function TransitionTide_Loop() {
			var x, y, imgindex, alpha;
			for (var x = 0; x < canvas.width; x++) {
				for (var y = 0; y < canvas.height; y++) {
					imgindex = (canvas.width * y + x) * 4;
					alpha = Math.min(1, Math.max(0, 20 * (y / canvas.height - TransitionCounter / 50) + Math.sin(20 * x / canvas.width - 0.8 * transitionTide_Shift + 20 * Math.tan(1.3 * (y / canvas.height - 0.5))) - (y / canvas.height - 0.5)));
					imgdata.data[imgindex] = backgroundColor[0];
					imgdata.data[imgindex + 1] = backgroundColor[1];
					imgdata.data[imgindex + 2] = backgroundColor[2];
					imgdata.data[imgindex + 3] = alpha * 0xFF;
				}
			}
			context.putImageData(imgdata, 0, 0);
			transitionTide_Shift += TransitionStep == 1 ? 0.1 * TransitionSpeedFadeIn : 1.3 * TransitionSpeedFadeOut;
			NextLoopCheck(TransitionTide_Loop, TransitionCounter >= -5, TransitionCounter < 50);
		}
		
		// Initialise a transition process
		function DoTransition(func, nextpage) {
			if (!EnableTransitions) {
				document.getElementById("ProjectFrame").src = nextpage;
				TransitionFunc = func;
				ProjectPage = nextpage;
				return;
			}
			if (TransitionStep != 0)
				return;
			canvas.hidden = false;
			TransitionStep = 1;
			TransitionCounter = 50;
			window.setTimeout(TransitionFunc, TransitionTimeout);
			TransitionFunc = func;
			ProjectPage = nextpage;
		}
		
		// Update which button is selected according to the current or incoming project page
		function UpdateSelectedProjectButton(index) {
			var projectButtons = document.getElementsByClassName("project-button");
			for (var btn of projectButtons)
				btn.classList.remove("selected-project");
			projectButtons[index].classList.add("selected-project");
		}
		
		// Perform a transition and update the project button
		function ClickProjectButton(index) {
			var targetProject = ProjectList[index];
			if (ProjectPage == targetProject[1])
				return;
			if (TransitionStep == 0) {
				DoTransition(targetProject[0], targetProject[1]);
			} else if (TransitionStep == 1) {
				TransitionFunc = targetProject[0];
				ProjectPage = targetProject[1];
			} else { // TransitionStep == 2
				TransitionStep = 1;
				TransitionFunc = targetProject[0];
				ProjectPage = targetProject[1];
			}
			UpdateSelectedProjectButton(index);
		}
		
		// Show/hide the project menu
		const buttonToggle = document.getElementsByClassName("project-menu-toggle")[0];
		const buttonInitialX = buttonToggle.style.left;
		const projectMenu = document.getElementsByClassName("project-menu")[0];
		var buttonToggleHidden = false;
		function ToggleProjectMenu(applyTransition) {
			if (applyTransition) {
				buttonToggle.classList.remove("disable-transition");
				projectMenu.classList.remove("disable-transition");
			} else {
				buttonToggle.classList.add("disable-transition");
				projectMenu.classList.add("disable-transition");
			}
			buttonToggleHidden = !buttonToggleHidden;
			buttonToggle.style.left = buttonToggleHidden ? 0 : buttonInitialX;
			buttonToggle.style.transform = buttonToggleHidden ? "scaleX(-1)" : "";
			projectMenu.style.transform = buttonToggleHidden ? "scaleX(0)" : "";
			for (var entry of projectMenu.children)
				entry.style.visibility = buttonToggleHidden ? "hidden" : "visible";
		}
		
		// Display the project page specified in the URL if any, or the first one
		const searchParams = new URLSearchParams(window.location.search);
		var projectIndex = searchParams.has("project") ? searchParams.get("project") : 0;
		if (!(projectIndex >= 0 && projectIndex < ProjectList.length))
			projectIndex = 0;
		document.getElementById("ProjectFrame").src = ProjectList[projectIndex][1];
		TransitionFunc = ProjectList[projectIndex][0];
		ProjectPage = ProjectList[projectIndex][1];
		UpdateSelectedProjectButton(projectIndex);
		if (searchParams.has("project")) {
			ToggleProjectMenu(false);
		} else {
			ShowAllProjects = true;
			projectMenu.hidden = true;
			buttonToggle.hidden = true;
		}
	}
	</script>
  </body>
</html>
